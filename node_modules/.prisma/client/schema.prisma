datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

//w: (start)╭────────────  PendingUser  ────────────╮
model PendingUser {
  id            String   @id @default(uuid(7)) @db.Uuid
  email         String   @unique
  password      String
  role          UserRole
  fullname      String
  //seler  info
  whatsapp      String?
  cellphone     String?
  shopname      String?
  shopaddress   String?
  shopLatitude  Float?
  shopLongitude Float?
  fcmToken      String?
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt

  @@map("Pending_users")
}

//w: (end)  ╰────────────  PendingUser  ────────────╯

//w: (start)╭────────────  User  ────────────╮
model User {
  id String @id @default(uuid(7)) @db.Uuid

  email                 String?        @unique
  password              String?
  role                  UserRole
  fullname              String
  profileimage          String?
  fcmTokens             String[]
  appleId               String?        @unique
  //seler  info
  whatsapp              String?
  cellphone             String?
  shopname              String?
  shopaddress           String?
  shopimage             String?
  shopLatitude          Float?
  shopLongitude         Float?
  createdAt             DateTime       @default(now())
  updatedAt             DateTime       @updatedAt
  lastLoginAt           DateTime       @default(now())
  receivedNotifications Notification[] @relation("notificationRecieve")
  sentNotifications     Notification[] @relation("notificationSend")

  @@map("users")
}

//w: (end)  ╰────────────  User  ────────────╯

enum UserRole {
  CLIENT
  SELLER
  ADMIN
  UNDEFINED
}

//w: (start)╭────────────  Notification  ────────────╮
model Notification {
  id String @id @default(uuid(7)) @db.Uuid

  title               String
  body                String?
  receiverId          String              @db.Uuid
  receiver            User                @relation("notificationRecieve", fields: [receiverId], references: [id])
  senderId            String?             @db.Uuid
  sender              User?               @relation("notificationSend", fields: [senderId], references: [id])
  type                NotificationType
  isRead              Boolean             @default(false)
  notificationChannel NotificationChannel @default(BOTH)
  metaData            Json?
  createdAt           DateTime            @default(now())
  updatedAt           DateTime            @updatedAt

  @@index([isRead])
  @@map("notifications")
}

//w: (end)  ╰────────────  Notification  ────────────╯

enum NotificationChannel {
  INAPP
  PUSH
  BOTH
}

enum NotificationType {
  CHAT
  CONNECTIONS
  SCHEDULE
  GROUP
  CHECKLISTENDGOAL
  SYSTEM
}
